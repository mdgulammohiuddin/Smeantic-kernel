@kernel_function(description="Get the current images from the app_images_tb")
    def fetch_images(self):
        connection = None
        cursor = None
        try:
            connection = psycopg2.connect(
                host="c-cdb-postgres-hni-oth-dev1-5.hskoo4dosu4n6i.postgres.cosmos.azure.com",
                database="citus",
                user="citus",
                password="sagjhqeTHJk452",
                port="5432"
            )
            cursor = connection.cursor()
            query = "SELECT * FROM app_images_tb WHERE app_name = 'AITalentQuest';"
            cursor.execute(query)
            result = cursor.fetchall
            print(f"Result -->{result}")
            if result["status"]:
            # Get column names from cursor description
                if len(result["output"]) > 0:
                    data = result["output"][0]
                    column_names = result["columns"]
                    images = dict(zip(column_names, data))
                    
                    # sample = json.loads(images['app_images'])
                    images['app_images'] = json.loads(images['app_images'])
                else:
                    return {
                    "status": False,
                    "output": {},
                    "message": "Images Not Found",
                    "error": ""
                    }
            else:
                return {
                "status": False,
                "output": {},
                "message": "Failed to Fetch Images",
                "error": ""
            }
            # Set default values to 0 for all columns
        
            return {
                "status": True,
                "output": images,
                "message": "Images Fetched Successfully",
                "error": ""
            }
    
        except Exception as e:
            
            return {
                "status": False,
                "output": {},
                "message": "Failed to Fetch Images",
                "error": str(e)
            }
        
        finally:
            print("In finally of fetch_images")
            if cursor:
                cursor.close()
            if connection:
                connection.close()
